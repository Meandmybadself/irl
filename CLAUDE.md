# IRL
This is a Node TypeScript service and UI providing a community directory for exchanging contact information.

## Core Technologies
* Node JS 22
* TypeScript
* PostGRES DB, using pooled connections.

## Node libraries
* Express
* `@prisma/client` - used for interacting with the PostGRES DB.
* `pg` - used for connecting to the PostGRES DB.
* `passport` - used to facilitate user authentication via Express sessions.
* `passport-local` - used for local authentication.
* `bcrypt` - used for hashing and salting passwords.
* `@sendgrid/mail` - used for sending emails to validate `User` email addresses and for resetting `User` passwords.
* `libphonenumber-js` - used for validating phone numbers.
* `zod` - used for validation of data.

## UI libraries / tools
* `lit` - web component framework
* `tailwindcss` - CSS
* `tailwindui` - UI
* `vite` - bundler

## Services
* `sendgrid` - Used for sending emails to validate `User` email addresses and for resetting `User` passwords.
* `nominatim` - Used for geocoding addresses.

## Folder Organization
* `client` - Contains all UI
* `shared` - Contains shared utilities and TypeScript types
* `server` - Contains constants, web service code / REST API services

## Code Organization

### client
Organize code into `pages`, `components`, `utilities`, `services` folders.

## Concepts / Models
All models should have `createdAt` `updatedAt` properties.
Models should use soft delete flags to avoid actual deletion from the database.

### ContactInformation
ContactInformation is a many-to-one relationship, allowing multiple `ContactInformation` entities to be associated with a single entity.
It should be applied using a mapping table.

Properties:
* `type` - Enum `email` `phone` `address` `url`
* `label` - string
* `privacy` - Enum `private` `public`

### User
`User` is a credential set allowing a user to authenticate with the system.

Properties:
* `email`
* `password`
* `verificationToken` - Used when validating user.  If the `verificationToken` exists

### Person
`Person` is symbolic of an actual human being associated with the organization.  Every `Person` must have an associated `User` for authentication and system access.
A `Person` can also be associated with multiple `Group`s.  When a `Person` is associated with a `Group`, it should be done with a mapping table allowing a `relation` to identify how the `Person` is associated with a `Group` (eg, `Parent` / `Teacher` / `Coach`).  The mapping should also identify if the `Person` is an `admin` of the `Group`.  A `Person` can have many `ContactInformation` entities associated with it.

`Person` objects can also be transferred between `User`s.  This is done when `User`s are generated by a `Group` creator and later transferred to the actual people via a `Claim`

Properties:
* `id` - number - primary key 
* `firstName` - string
* `lastName` - string
* `displayId` - A unique, web-safe string for 
* `pronouns` - string
* `imageURL` - string
* `contactInformations` - comprised using the `ContactInformation` mapping tables

### System
`System` is the root of all models, detailing the organization in general.
It can have multiple `ContactInformation` entities associated with it.
Only one system can exist for the entire organization.

Properties:
* `name`
* `registrationOpen`
* `contactInformations` - comprised using the `ContactInformation` mapping tables
* `adminUsers` - A list of `User`s who can administrate the system.

### Group
`Group` is a collection of `Person`s.  It can be used to group `Person`s for a variety of purposes.

Properties:
* `id` - Primary Key
* `displayId` - unique string (URL slug)
* `name`
* `description`
* `people` - comprised using the `Person` mapping tables
* `parentGroup` - parent `Group` ID
* `adminPersons` - comprised using the `Person` mapping tables
* `memberPersons` - comprised using the `Person` mapping tables
* `contactInformations` - comprised using the `ContactInformation` mapping tables
* `allowsAnyUserToCreateSubgroup` - boolean
* `publiclyVisible` - boolean

## Steps for development
* Persist additional development steps in `TODOs.md`.  Add new tasks that need to be accomplished and mark tasks that have been previously completed.
* Following individual updates:
    * Run `pnpm build` to ensure that the applied changes are buildable.
    * Check to see if new functionality was added that already exists elsewhere in the system.
    * If buildable, make a git commit detailing the updates.

## Available Tools
* `gh` - Use for interacting with Github